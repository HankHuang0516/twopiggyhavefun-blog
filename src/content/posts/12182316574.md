---
title: "#include &lt;SoftwareSerial.h&gt; #define _baudrat..."
date: "2015-12-21T15:34:02.000Z"
cover: "https://pimg.1px.tw/blog/lolwarden/logo/841522413162664851.webp"
tags: ["pixnet", "unread"]
originalUrl: "https://lolwarden.pixnet.net/blog/posts/12182316574"
businessHours: null
isPermanentlyClosed: false
category: "Code"
---

<div class="pixnet-article prose max-w-none">
<pre style="font-family: Andale Mono, Lucida Console, Monaco, fixed, monospace; color: #000000; background-color: #eee; font-size: 12px; border: 1px dashed #999999; line-height: 14px; padding: 5px; overflow: auto; width: 100%;"><code>#include &lt;SoftwareSerial.h&gt;<br>#define _baudrate   9600<br>#define _rxpin      4<br>#define _txpin      5<br>SoftwareSerial debug( _rxpin, _txpin ); // RX, TX<br>//*-- IoT Information<br>#define SSID "?"<br>#define PASS "?"<br>#define IP "184.106.153.149" // ThingSpeak IP Address: 184.106.153.149<br>// 使用 GET 傳送資料的格式<br>// GET /update?key=[THINGSPEAK_KEY]&amp;field1=[data 1]&amp;filed2=[data 2]...;<br>String GET = "GET /update?key=?";<br><br>void setup() {<br>    Serial.begin( _baudrate );<br>    debug.begin( _baudrate );<br>    sendDebug("AT");<br>    Loding("sent AT");<br>    connectWiFi();<br>}<br>void loop() {<br>    delay(5000);   // 60 second<br>    SentOnCloud( String(5), String(9) );<br>}<br>boolean connectWiFi()<br>{<br>    debug.println("AT+CWMODE=1");<br>    Wifi_connect();<br>}<br><br>void SentOnCloud( String T, String H )<br>{<br>    // 設定 ESP8266 作為 Client 端<br>    String cmd = "AT+CIPSTART=\"TCP\",\"";<br>    cmd += IP;<br>    cmd += "\",80";<br>    sendDebug(cmd);<br>    if( debug.find( "Error" ) )<br>    {<br>        Serial.print( "RECEIVED: Error\nExit1" );<br>        return;<br>    }<br>    cmd = GET + "&amp;field1=" + T + "&amp;field2=" + H +"\r\n";<br>    debug.print( "AT+CIPSEND=" );<br>    debug.println( cmd.length() );<br>    if(debug.find( "&gt;" ) )<br>    {<br>        Serial.print("&gt;");<br>        Serial.print(cmd);<br>        debug.print(cmd);<br>    }<br>    else<br>    {<br>        debug.print( "AT+CIPCLOSE" );<br>    }<br>    if( debug.find("OK") )<br>    {<br>        Serial.println( "RECEIVED: OK" );<br>    }<br>    else<br>    {<br>        Serial.println( "RECEIVED: Error\nExit2" );<br>    }<br>}<br>void Wifi_connect()<br>{<br>    String cmd="AT+CWJAP=\"";<br>    cmd+=SSID;<br>    cmd+="\",\"";<br>    cmd+=PASS;<br>    cmd+="\"";<br>    sendDebug(cmd);<br>    Loding("Wifi_connect");<br>}<br>void Loding(String state){<br>    for (int timeout=0 ; timeout&lt;10 ; timeout++)<br>    {<br>      if(debug.find("OK"))<br>      {<br>          Serial.println("RECEIVED: OK");<br>          break;<br>      }<br>      else if(timeout==9){<br>        Serial.print( state );<br>        Serial.println(" fail...\nExit2");<br>      }<br>      else<br>      {<br>        Serial.print("Wifi Loading...");<br>        delay(500);<br>      }<br>    }<br>}<br>void sendDebug(String cmd)<br>{<br>    Serial.print("SEND: ");<br>    Serial.println(cmd);<br>    debug.println(cmd);<br>} <br></code></pre>
</div>
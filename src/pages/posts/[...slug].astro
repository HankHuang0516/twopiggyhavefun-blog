---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
  <article class="max-w-4xl mx-auto px-4 py-8">
    <header class="mb-10 text-center">
        <div class="mb-8 text-left">
            <a href="/twopiggyhavefun-blog/" class="text-pink-600 hover:text-pink-700 font-medium flex items-center gap-2">
                ← Back to Home
            </a>
        </div>
        <div class="w-full h-[400px] mb-8 rounded-2xl overflow-hidden shadow-lg">
            <img 
                src={post.data.cover} 
                alt={post.data.title}
                class="w-full h-full object-cover"
            />
        </div>
      )}
      <div class="mb-4 text-gray-500 font-medium">
        {new Date(post.data.date).toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' })}
      </div>
      <h1 class="text-3xl md:text-5xl font-bold text-gray-900 leading-tight mb-6">
        {post.data.title}
      </h1>
      <div class="flex justify-center flex-wrap gap-2">
        {post.data.tags?.map(tag => (
            <span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm">#{tag}</span>
        ))}
        <a href={post.data.originalUrl} target="_blank" rel="noopener noreferrer" class="bg-pink-100 text-pink-600 px-3 py-1 rounded-full text-sm hover:bg-pink-200 transition">
            Original Pixnet Post ↗
        </a>
      </div>
    </header>

    <div class="prose prose-lg prose-pink max-w-none bg-white p-8 md:p-12 rounded-2xl shadow-sm border border-gray-100 pixnet-content">
      <Content />
    </div>
  </article>
</Layout>

<style is:global>
    /* Pixnet Specific Overrides to preserve layout */
    .pixnet-content img {
        margin: 1.5em auto;
        border-radius: 8px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        max-width: 100%;
        height: auto;
    }
    .pixnet-content iframe {
        max-width: 100%;
        margin: 1.5em auto;
    }
    .pixnet-content p {
        margin-bottom: 1.5em;
        line-height: 1.8;
    }
    /* Restoration of some reset styles that Tailwind might strip */
    .pixnet-content ul { list-style-type: disc; padding-left: 1.5em; }
    .pixnet-content ol { list-style-type: decimal; padding-left: 1.5em; }
</style>
